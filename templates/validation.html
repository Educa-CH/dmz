{% extends "base.html" %}

{% block head %}
    <title>Validation</title>
        <script>


 async function checkSwiyuProof() {
            const response = await fetch('/check/{{ swiyu_proof_id }}');
            const result = await response.json();
            if (result.state === "ACCEPTED") {
                window.location.href = '/swiyusuccess?claims=' + encodeURIComponent(result.claims.join(' / '));
            }
            else {
                window.location.href = '/swiyufailure';
            }
        }
        window.onload = function() {
        const proofId = "{{ swiyu_proof_id }}";
        if (proofId && proofId.trim() !== "") {
            checkSwiyuProof();
        } else {
            console.log("No Swiyu proof ID available, skipping checkSwiyuProof()");
        }
    };
    </script>
{% endblock %}

{% block index %}
    <h1>Validieren des Maturazeugnis</h1>
    <h2>Scannen Sie den QR-Code mit ihrer Wallet!</h2>

    <img src="data:image/png;base64,{{ qr_code_base64 }}" alt="QR Code" style="width: 250px; height: 250px;">
{% endblock %}